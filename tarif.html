<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>TABEL TARIF TANJUNG PERAK</title>
  <link rel="stylesheet" href="assets/css/neo-buttons.css" />
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&display=swap" rel="stylesheet">
  <style>
    :root { color-scheme: light dark; }
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; margin: 16px; }
    h1 { font-size: 18px; margin: 0 0 12px; }
    .tabs { display: flex; gap: 18px; flex-wrap: wrap; margin-bottom: 16px; }
    .panel { display: none; }
    .panel.active { display: block; }
    .status { margin: 8px 0; font-size: 12px; opacity: 0.8; }
    .table-wrap { border: 1px solid #ccc; border-radius: 6px; overflow: hidden; }
    .scroll { overflow: auto; max-height: 70vh; }
    table { border-collapse: collapse; width: 100%; font-size: 12px; }
    /* Header tabel: biru gelap, teks putih, rata tengah */
    thead th {
      position: sticky;
      top: 0;
      z-index: 1;
      background: #0d47a1;            /* biru gelap */
      color: #fff;                    /* tulisan putih */
      font-weight: 700;
      padding: 10px 12px;
      text-align: center;             /* judul header center */
      border-bottom: 1px solid rgba(255,255,255,0.2);
      backdrop-filter: none;
      -webkit-backdrop-filter: none;
      box-shadow: 0 1px 0 rgba(255,255,255,.06) inset, 0 2px 6px rgba(0,0,0,.08);
    }
    tbody td { border-bottom: 1px solid #eee; padding: 6px; }
    tbody tr:nth-child(even) { background: rgba(0,0,0,0.03); }
    code.small { font-size: 11px; opacity: 0.8; }

    /* Sentuhan aktif agar mirip contoh (lebih terang & bayangan lebih dalam) */
    .tabs .neo-btn.active {
      filter: brightness(1.06);
      box-shadow: 0 14px 26px rgba(0,0,0,.30), inset 0 0 0 1px rgba(255,255,255,.14);
    }
    /* Helper untuk mendorong tombol ke ujung kanan */
    .tabs .push-end { margin-left: auto; }

    /* Futuristic title style (same as outstanding.html) */
    .futuristic-title {
      display:flex;
      justify-content:center;
      align-items:center;
      gap:.8rem;
      width:100%;
      margin:0 auto 8px;
      font-family:'Orbitron', Arial, sans-serif;
      font-size:clamp(2rem,3.6vw,3.4rem);
      font-weight:700;
      text-transform:uppercase;
      letter-spacing:.08rem;
      background:linear-gradient(90deg,#9ffbff 0%,#65ffd9 25%,#ffe580 50%,#ffb3f5 75%,#ffffff 100%);
      background-clip:text;
      -webkit-background-clip:text;
      color:transparent;
      -webkit-text-fill-color: transparent;
      position:relative;
      padding:.2rem .4rem;
      border-radius:0;
      filter:none;
      text-shadow:
        0 0 2px rgba(244,200,200,.85),
        0 0 4px rgba(241,199,199,.75),
        0 2px 6px rgba(0,0,0,.6),
        0 0 10px rgba(125,249,255,.8),
        0 0 18px rgba(84,255,228,.55),
        0 0 28px rgba(255,157,240,.45);
    }
    .futuristic-title::before,
    .futuristic-title::after { content:none !important; display:none !important; }
    .futuristic-title span {
      display:inline-block;
      animation:glowPulse 3.8s ease-in-out infinite;
      text-shadow:
        0 0 2px rgba(61,26,26,.85),
        0 0 4px rgba(56,26,26,.7),
        0 1px 5px rgba(0,0,0,.55),
        0 0 8px rgba(125,249,255,.85),
        0 0 16px rgba(84,255,228,.6),
        0 0 24px rgba(255,157,240,.5);
    }
    .futuristic-title .fx-accent { animation-delay:.5s; }
    .futuristic-title .fx-highlight { animation-delay:1s; }
    @keyframes glowPulse {
      0%,100% {
        opacity:1;
        text-shadow:
          0 0 2px rgba(9,9,9,.9),
          0 0 4px rgba(55,55,57,.7),
          0 1px 6px rgba(0,0,0,.55),
          0 0 10px rgba(125,249,255,.9),
          0 0 20px rgba(84,255,228,.7),
          0 0 32px rgba(255,157,240,.55);
      }
      50% {
        opacity:.95;
        text-shadow:
          0 0 2px rgba(174,177,240,.85),
          0 0 3px rgba(0,0,0,.65),
          0 1px 5px rgba(0,0,0,.55),
          0 0 6px rgba(125,249,255,.65),
          0 0 14px rgba(84,255,228,.5),
          0 0 24px rgba(255,157,240,.42);
      }
    }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
</head>
<body>
  <h1 class="text-center mb-4 futuristic-title">
    <span class="fx-primary">Tabel</span>
    <span class="fx-accent">Tarif</span>
    <span class="fx-highlight">Tanjung Perak</span>
  </h1>

  <div class="tabs" id="tabButtons">
    <a class="neo-btn neo-btn--blue neo-btn--sm active" data-tab="pandu" data-csv="tarifpandu.csv">
      <span class="neo-btn__label">Pandu</span><span class="neo-btn__icon">⬇</span>
    </a>
    <a class="neo-btn neo-btn--purple neo-btn--sm" data-tab="tug" data-csv="tarif_tug.csv">
      <span class="neo-btn__label">Tunda</span><span class="neo-btn__icon">→</span>
    </a>
    <a class="neo-btn neo-btn--teal neo-btn--sm" data-tab="tambat" data-csv="tariftambat.csv">
      <span class="neo-btn__label">Tambat</span><span class="neo-btn__icon">→</span>
    </a>
    <a class="neo-btn neo-btn--orange neo-btn--sm" data-tab="kepil" data-csv="tarifkepil.csv">
      <span class="neo-btn__label">Kepil</span><span class="neo-btn__icon">→</span>
    </a>
    <a href="outstanding.html" class="neo-btn neo-btn--green neo-btn--sm push-end">
      <span class="neo-btn__label">Dashboard</span><span class="neo-btn__icon">➜</span>
    </a>
  </div>

  <div id="panels">
    <div id="panel-pandu" class="panel active">
      <div class="status">Menunggu data...</div>
      <div class="table-wrap"><div class="scroll"><table></table></div></div>
    </div>
    <div id="panel-tug" class="panel">
      <div class="status">Menunggu data...</div>
      <div class="table-wrap"><div class="scroll"><table></table></div></div>
    </div>
    <div id="panel-tambat" class="panel">
      <div class="status">Menunggu data...</div>
      <div class="table-wrap"><div class="scroll"><table></table></div></div>
    </div>
    <div id="panel-kepil" class="panel">
      <div class="status">Menunggu data...</div>
      <div class="table-wrap"><div class="scroll"><table></table></div></div>
    </div>
  </div>

  <script>
    const loaded = new Set();

    // Header label mapping khusus Pandu
    const panduHeaderMap = {
      code_per_water_name: 'Perairan',
      currency_name: 'Mata Uang',
      fixed_rate: 'Tarif Tetap',
      variable_rate: 'Tarif Variabel',
      movement_type: 'Pergerakan',
      zone_name: 'Zona',
      description: 'Keterangan',
    };
    // Tambah: urutan/daftar kolom yang ditampilkan untuk Pandu
    const panduFields = [
      'code_per_water_name',
      'currency_name',
      'fixed_rate',
      'variable_rate',
      'movement_type',
      'zone_name',
      'description',
    ];

    // Tambah: mapping dan field untuk Tunda/Tug
    const tugHeaderMap = {
      currency_name: 'Mata Uang',
      fixed_rate: 'Tarif Tetap',
      variable_rate: 'Tarif Variabel',
      gt_group_name: 'Golongan GT',
      tug_type: 'Tipe Layanan',
      zone_name: 'Zona',
    };
    const tugFields = [
      'currency_name',
      'fixed_rate',
      'variable_rate',
      'gt_group_name',
      'tug_type',
      'zone_name',
    ];

    // Tambah: mapping dan field untuk Kepil
    const kepilHeaderMap = {
      location_name: 'Lokasi',
      currency_name: 'Mata Uang',
      amount: 'Tarif',
      description: 'Deskripsi',
      loa_description: 'LOA',
    };
    const kepilFields = [
      'location_name',
      'currency_name',
      'amount',
      'description',
      'loa_description',
    ];

    // Tambah: mapping dan field untuk Tambat (Mooring)
    const tambatHeaderMap = {
      currency_name: 'Mata Uang',
      fixed_rate: 'Tarif',
      description: 'Deskripsi',
      zone_name: 'Zona',
    };
    const tambatFields = [
      'currency_name',
      'fixed_rate',
      'description',
      'zone_name',
    ];

    function renderTable(panel, rows, fields, headerMap) {
      const table = panel.querySelector('table');
      table.innerHTML = "";

      const thead = document.createElement('thead');
      const trHead = document.createElement('tr');
      (fields || Object.keys(rows[0] || {})).forEach(h => {
        const th = document.createElement('th');
        th.textContent = (headerMap && headerMap[h]) ? headerMap[h] : h;
        trHead.appendChild(th);
      });
      thead.appendChild(trHead);

      const tbody = document.createElement('tbody');
      rows.forEach(obj => {
        const tr = document.createElement('tr');
        (fields || Object.keys(obj)).forEach(k => {
          const td = document.createElement('td');
          const v = obj[k];
          td.textContent = (v === null || v === undefined) ? "" : String(v);
          tr.appendChild(td);
        });
        tbody.appendChild(tr);
      });

      table.appendChild(thead);
      table.appendChild(tbody);
    }

    function loadCsvIntoPanel(csvPath, panelId) {
      const panel = document.getElementById(panelId);
      const statusEl = panel.querySelector('.status');
      statusEl.textContent = `Memuat ${csvPath} ...`;

      Papa.parse(csvPath, {
        download: true,
        header: true,
        skipEmptyLines: true,
        complete: (res) => {
          const rows = res.data || [];
          const fields = res.meta && res.meta.fields ? res.meta.fields : (rows[0] ? Object.keys(rows[0]) : []);

          // Terapkan filter kolom + label khusus per panel
          let headerMap;
          let selectedFields = fields;
          if (panelId === 'panel-pandu') {
            headerMap = panduHeaderMap;
            selectedFields = panduFields.filter(k => fields.includes(k));
          } else if (panelId === 'panel-tug') {
            headerMap = tugHeaderMap;
            selectedFields = tugFields.filter(k => fields.includes(k));
          } else if (panelId === 'panel-kepil') {
            headerMap = kepilHeaderMap;
            selectedFields = kepilFields.filter(k => fields.includes(k));
          } else if (panelId === 'panel-tambat') {
            headerMap = tambatHeaderMap;
            selectedFields = tambatFields.filter(k => fields.includes(k));
          }

          statusEl.innerHTML = `Baris: <code class="small">${rows.length}</code>`;
          renderTable(panel, rows, selectedFields, headerMap);
        },
        error: (err) => {
          statusEl.textContent = `Gagal memuat ${csvPath}: ${err}`;
        }
      });
    }

    function activate(tabBtn) {
      document.querySelectorAll('.tabs [data-tab]').forEach(b => b.classList.remove('active'));
      tabBtn.classList.add('active');

      const tab = tabBtn.dataset.tab;
      document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
      const panelId = `panel-${tab}`;
      document.getElementById(panelId).classList.add('active');

      const csv = tabBtn.dataset.csv;
      const key = `${tab}:${csv}`;
      if (!loaded.has(key)) {
        loadCsvIntoPanel(csv, panelId);
        loaded.add(key);
      }
    }

    document.getElementById('tabButtons').addEventListener('click', (e) => {
      const btn = e.target.closest('[data-tab]');
      if (btn) activate(btn);
    });

    // Auto-load first (active) tab
    window.addEventListener('DOMContentLoaded', () => {
      const first = document.querySelector('.tabs [data-tab].active');
      if (first) activate(first);
    });
  </script>

</body>
</html>

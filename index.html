<!DOCTYPE html>
<html lang="id">
<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>Login</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" />
	<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&display=swap" rel="stylesheet" />
	<link rel="stylesheet" href="assets/css/neo-buttons.css" />
	<style>
		/* Futuristic soft blue background (match index.html) */
		html, body { height: 100%; }
		body {
			background-color: #eaf6ff;
			background-image:
				radial-gradient(1000px 800px at 20% 10%, rgba(173,216,230,.35) 0%, rgba(173,216,230,0) 60%),
				radial-gradient(800px 600px at 80% 20%, rgba(125,249,255,.22) 0%, rgba(125,249,255,0) 55%),
				radial-gradient(900px 700px at 30% 80%, rgba(84,255,228,.16) 0%, rgba(84,255,228,0) 55%),
				linear-gradient(180deg, #f4fbff 0%, #e7f6ff 50%, #ecfaff 100%);
			background-attachment: fixed, fixed, fixed, fixed;
			background-size: auto, auto, auto, 100% 100%;
			background-repeat: no-repeat;
		}
		body::after {
			content: "";
			position: fixed;
			inset: 0;
			pointer-events: none;
			background: linear-gradient(120deg,
				rgba(145,194,255,.18),
				rgba(125,249,255,.12),
				rgba(173,216,230,.18)
			);
			background-size: 300% 300%;
			animation: gradientShift 18s ease-in-out infinite;
			mix-blend-mode: screen;
		}
		@keyframes gradientShift {
			0% { background-position: 0% 50%; }
			50% { background-position: 100% 50%; }
			100% { background-position: 0% 50%; }
		}
		@media (prefers-reduced-motion: reduce) { body::after { animation: none; } }

		.login-card {
			width: 100%; max-width: 420px;
			background: rgba(255,255,255,0.75);
			backdrop-filter: blur(10px) saturate(110%);
			-webkit-backdrop-filter: blur(10px) saturate(110%);
			border: 1px solid rgba(255,255,255,0.45);
			border-radius: 14px;
			box-shadow: 0 10px 20px rgba(0,0,0,.12);
			padding: 22px 20px;
		}
		.login-title {
			font-family:'Orbitron', Arial, sans-serif;
			font-weight:700; letter-spacing:.04rem; text-align:center;
			background:linear-gradient(90deg,#9ffbff 0%,#65ffd9 25%,#ffe580 50%,#ffb3f5 75%,#ffffff 100%);
			-webkit-background-clip:text; background-clip:text; color:transparent;
			-webkit-text-fill-color: transparent;
			text-shadow: 0 1px 2px rgba(0,0,0,.15);
		}
		.form-control { border-radius: 10px; }
		.form-check-label { user-select:none; }
		.error-text { color:#c0392b; font-size:.9rem; min-height: 1.2em; }
	</style>
</head>
<body>
	<div class="container min-vh-100 d-flex align-items-center justify-content-center py-5">
		<div class="login-card">
			<h2 class="login-title mb-3">Masuk</h2>
			<form id="loginForm" novalidate>
				<div class="mb-3">
					<label for="username" class="form-label">Username</label>
					<input type="text" id="username" class="form-control" autocomplete="username" required />
				</div>
				<div class="mb-2">
					<label for="password" class="form-label">Password</label>
					<div class="input-group">
						<input type="password" id="password" class="form-control" autocomplete="current-password" required />
						<button type="button" class="btn btn-outline-secondary" id="togglePass" aria-label="Tampilkan/Sembunyikan Password">üëÅ</button>
					</div>
				</div>
				<div class="d-flex justify-content-between align-items-center mb-3">
					<div class="form-check">
						<input class="form-check-input" type="checkbox" id="rememberMe" />
						<label class="form-check-label" for="rememberMe">Ingat saya</label>
					</div>
					<a href="#" id="clearSession" class="small text-decoration-none">Bersihkan sesi</a>
				</div>
				<div class="error-text mb-2" id="errBox"></div>
				<button type="submit" class="neo-btn neo-btn--teal w-100">
					<span class="neo-btn__label">Login</span>
					<span class="neo-btn__icon">‚Üí</span>
				</button>
			</form>
		</div>
	</div>

	<script src="assets/js/auth.js"></script>
	<script>
		// Konfigurasi kredensial sederhana (ubah sesuai kebutuhan Anda)
		const VALID_USER = (window.LOGIN_USERNAME) || 'admin';
		const VALID_PASS = (window.LOGIN_PASSWORD) || '@pelindo123';

		// Utilitas token sederhana
		const TOKEN_KEY = 'auth_token';
		const USER_KEY = 'auth_user';
		const EXP_KEY = 'auth_exp';

		function isLoggedIn() {
			const t = localStorage.getItem(TOKEN_KEY);
			const exp = parseInt(localStorage.getItem(EXP_KEY) || '0', 10);
			if (!t || !exp) return false;
			return Date.now() < exp;
		}

		function setSession(username, days) {
			const token = Math.random().toString(36).slice(2) + Date.now().toString(36);
			const expMs = (days || 1) * 24 * 60 * 60 * 1000; // default 1 hari
			localStorage.setItem(TOKEN_KEY, token);
			localStorage.setItem(USER_KEY, username);
			localStorage.setItem(EXP_KEY, (Date.now() + expMs).toString());
			// set last activity now
			localStorage.setItem('auth_last_activity', String(Date.now()));
		}

		function clearSession() {
			localStorage.removeItem(TOKEN_KEY);
			localStorage.removeItem(USER_KEY);
			localStorage.removeItem(EXP_KEY);
		}

		function getRedirect() {
			const url = new URL(window.location.href);
			return url.searchParams.get('redirect') || 'outstanding.html';
		}

		// Jika sudah login, langsung alihkan
		if (isLoggedIn()) {
			window.location.replace(getRedirect());
		}

		// Interaksi form
		const form = document.getElementById('loginForm');
		const errBox = document.getElementById('errBox');
		const toggleBtn = document.getElementById('togglePass');
		const passInput = document.getElementById('password');
		const rememberMe = document.getElementById('rememberMe');
		const clearBtn = document.getElementById('clearSession');

		toggleBtn.addEventListener('click', () => {
			const t = passInput.getAttribute('type') === 'password' ? 'text' : 'password';
			passInput.setAttribute('type', t);
		});

		clearBtn.addEventListener('click', (e) => {
			e.preventDefault();
			clearSession();
			errBox.textContent = 'Sesi dibersihkan.';
			setTimeout(() => errBox.textContent = '', 1500);
		});

		form.addEventListener('submit', (e) => {
			e.preventDefault();
			errBox.textContent = '';
			const u = (document.getElementById('username').value || '').trim();
			const p = passInput.value || '';
			if (!u || !p) {
				errBox.textContent = 'Username dan password wajib diisi.';
				return;
			}
			// Validasi sederhana (tanpa backend)
			if (u.toLowerCase() === String(VALID_USER).toLowerCase() && p === String(VALID_PASS)) {
				setSession(u, rememberMe.checked ? 30 : 1);
				window.location.replace('outstanding.html');
			} else {
				errBox.textContent = 'Kredensial tidak valid.';
			}
		});
	</script>
</body>
</html>

